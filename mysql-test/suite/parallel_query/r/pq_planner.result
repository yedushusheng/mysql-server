### enable parallel query forcibly with maximum parallel degree = 4 and cost/records threshold = 0 ###
CREATE TABLE t1(a INT, b INT, c INT);
INSERT INTO t1 VALUES(1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5),(1,1,1),(2,2,2),(3,3,3),(4,4,4),(5,5,5);
EXPLAIN format=tree SELECT a FROM t1 HAVING a = 1;
EXPLAIN
-> Gather (slice: 1, workers: 4)  (cost=N.NNN rows=NNN)
    -> Filter: (t1.a = 1)  (cost=N.NNN rows=NNN)
        -> Table scan on t1  (cost=N.NNN rows=NNN)

SELECT a FROM t1 HAVING a = 1;
a
1
1
DROP TABLE t1;
CREATE TABLE t1(a INT);
INSERT INTO t1 VALUES(1),(2),(3);
EXPLAIN format=tree SELECT IF( a = 1, a, a ) AS `b` FROM t1 ORDER BY field( `b` + 1, 1 );
EXPLAIN
-> Gather (slice: 1, workers: 4) with merge sort: `field((b + 1),1)`  (cost=N.NNN rows=NNN)
    -> Sort: field((b + 1),1)  (cost=N.NNN rows=NNN)
        -> Table scan on t1  (cost=N.NNN rows=NNN)

SELECT IF( a = 1, a, a ) AS `b` FROM t1 ORDER BY field( `b` + 1, 1 );
b
1
2
3
DROP TABLE t1;
CREATE TABLE t1 (f1 INTEGER);
EXPLAIN format=tree SELECT (SELECT COUNT(*) + (SELECT COUNT(*) FROM t1 WHERE f1 = c.f2) FROM t1) FROM (SELECT 555 AS f2) AS c;
EXPLAIN
-> Rows fetched before execution  (cost=0.00..0.00 rows=1)
-> Select #2 (subquery in projection; dependent)
    -> Aggregate: count(0)  (cost=N.NNN rows=NNN)
        -> Table scan on t1  (cost=N.NNN rows=NNN)
    -> Select #3 (subquery in projection; dependent)
        -> Aggregate: count(0)  (cost=N.NNN rows=NNN)
            -> Filter: (t1.f1 = '555')  (cost=N.NNN rows=NNN)
                -> Table scan on t1  (cost=N.NNN rows=NNN)
    -> Select #3 (subquery in projection; dependent)
        -> Aggregate: count(0)  (cost=N.NNN rows=NNN)
            -> Filter: (t1.f1 = '555')  (cost=N.NNN rows=NNN)
                -> Table scan on t1  (cost=N.NNN rows=NNN)

Warnings:
Note	1276	Field or reference 'c.f2' of SELECT #3 was resolved in SELECT #1
SELECT (SELECT COUNT(*) + (SELECT COUNT(*) FROM t1 WHERE f1 = c.f2) FROM t1) FROM (SELECT 555 AS f2) AS c;
(SELECT COUNT(*) + (SELECT COUNT(*) FROM t1 WHERE f1 = c.f2) FROM t1)
0
DROP TABLE t1;
CREATE TABLE t1(a INT NOT NULL, PRIMARY KEY(a));
INSERT INTO t1 VALUES(1),(2);
EXPLAIN format=tree SELECT max(a), max(concat("*", a, "*")) FROM t1;;
EXPLAIN
-> Aggregate: max(`max(concat('*',t1.a,'*'))`)  (cost=N.NNN rows=NNN)
    -> Gather (slice: 1, workers: 4)
        -> Aggregate: max(concat('*',t1.a,'*'))  (cost=N.NNN rows=NNN)
            -> Index scan on t1 using PRIMARY  (cost=N.NNN rows=NNN)

SELECT max(a), max(concat("*", a, "*")) FROM t1;;
max(a)	max(concat("*", a, "*"))
2	*2*
DROP TABLE t1;
CREATE TABLE t1 (
Period smallint(4) unsigned zerofill DEFAULT '0000' NOT NULL,
Varor_period smallint(4) unsigned DEFAULT '0' NOT NULL
);
Warnings:
Warning	1681	The ZEROFILL attribute is deprecated and will be removed in a future release. Use the LPAD function to zero-pad numbers, or store the formatted numbers in a CHAR column.
Warning	1681	Integer display width is deprecated and will be removed in a future release.
Warning	1681	Integer display width is deprecated and will be removed in a future release.
INSERT INTO t1 VALUES (9410,9412);
EXPLAIN format=tree SELECT 1+1 AS summa FROM t1 GROUP BY summa LIMIT 1;
EXPLAIN
-> Limit: 1 row(s)  (cost=N.NNN rows=NNN)
    -> Group (no aggregates)  (cost=N.NNN rows=NNN)
        -> Gather (slice: 1, workers: 4)
            -> Group (no aggregates)  (cost=N.NNN rows=NNN)
                -> Table scan on t1  (cost=N.NNN rows=NNN)

SELECT 1+1 AS summa FROM t1 GROUP BY summa LIMIT 1;
summa
2
DROP TABLE t1;
CREATE TABLE `t` (
`a` varbinary(10) DEFAULT NULL
);
INSERT INTO t VALUES(0xFF00F0F0), (NULL), (0xF0F0FF00);
EXPLAIN format=tree SELECT SQL_BUFFER_RESULT HEX(BIT_AND(a)), HEX(BIT_OR(a)), HEX(BIT_XOR(a)) FROM t;
EXPLAIN
-> Aggregate: bit_xor(a), bit_or(a), bit_and(a)  (cost=1.80..3.69 rows=3)
    -> Gather (slice: 1, workers: 4)
        -> Aggregate: bit_xor(t.a), bit_or(t.a), bit_and(t.a)  (cost=1.80..3.69 rows=3)
            -> Table scan on <temporary>  (cost=0.85..2.54 rows=3)
                -> Temporary table  (cost=1.70..3.39 rows=3)
                    -> Table scan on t  (cost=N.NNN rows=NNN)

SELECT SQL_BUFFER_RESULT HEX(BIT_AND(a)), HEX(BIT_OR(a)), HEX(BIT_XOR(a)) FROM t;
HEX(BIT_AND(a))	HEX(BIT_OR(a))	HEX(BIT_XOR(a))
F000F000	FFF0FFF0	0FF00FF0
DROP TABLE t;
CREATE TABLE t (group_id int, a varbinary(10));
INSERT INTO t(group_id, a) VALUES
(1, 0x34567101ABFF00F0F0),
(2, NULL),
(1, 0x34567102ABF0F0F0F0),
(3, 0x34567104ABF0F0F0F0),
(1, 0x34567103ABFF00F0F0),
(5, 0xABCDEF),
(5, 0x123456),
(5, 0x789123),
(1, 0x34567104ABF0F0F0F0),
(4, 0x34567100ABF0F0F0F0),
(4, NULL),
(4, 0x34567101ABFF00F0F0);
SELECT group_id, HEX(BIT_AND(a)), HEX(BIT_OR(a)), HEX(BIT_XOR(a))
FROM t
GROUP BY group_id;
group_id	HEX(BIT_AND(a))	HEX(BIT_OR(a))	HEX(BIT_XOR(a))
1	34567100ABF000F0F0	34567107ABFFF0F0F0	000000040000000000
2	FFFFFFFFFFFFFFFFFFFF	00000000000000000000	00000000000000000000
3	34567104ABF0F0F0F0	34567104ABF0F0F0F0	34567104ABF0F0F0F0
4	34567100ABF000F0F0	34567101ABFFF0F0F0	00000001000FF00000
5	000002	FBFDFF	C1689A
SELECT group_id, HEX(BIT_AND(a)), BIT_AND(192), BIT_AND(0x303233), BIT_AND(binary "foo")
FROM t
GROUP BY group_id;
group_id	HEX(BIT_AND(a))	BIT_AND(192)	BIT_AND(0x303233)	BIT_AND(binary "foo")
1	34567100ABF000F0F0	192	3158579	foo
2	FFFFFFFFFFFFFFFFFFFF	192	3158579	foo
3	34567104ABF0F0F0F0	192	3158579	foo
4	34567100ABF000F0F0	192	3158579	foo
5	000002	192	3158579	foo
DROP TABLE t;
CREATE TABLE `t1` (
`i` int DEFAULT NULL,
`d` date DEFAULT NULL
);
INSERT INTO t1 VALUES (1, '2008-01-01'), (2, '2008-01-02'), (3, '2008-01-03');
EXPLAIN format=tree SELECT COALESCE(d, d), IFNULL(d, d), IF(i, d, d), CASE i WHEN i THEN d ELSE d END, GREATEST(d, d), LEAST(d, d) FROM t1 ORDER BY RAND();
EXPLAIN

            -> Table scan on t1  (cost=N.NNN rows=NNN)
        -> Stream results  (cost=N.NNN rows=NNN)
    -> Sort: `rand()`
-> Gather (slice: 1, workers: 4) with merge sort: `rand()`
SELECT COALESCE(d, d), IFNULL(d, d), IF(i, d, d), CASE i WHEN i THEN d ELSE d END, GREATEST(d, d), LEAST(d, d) FROM t1 ORDER BY RAND();
COALESCE(d, d)	IFNULL(d, d)	IF(i, d, d)	CASE i WHEN i THEN d ELSE d END	GREATEST(d, d)	LEAST(d, d)
2008-01-01	2008-01-01	2008-01-01	2008-01-01	2008-01-01	2008-01-01
2008-01-02	2008-01-02	2008-01-02	2008-01-02	2008-01-02	2008-01-02
2008-01-03	2008-01-03	2008-01-03	2008-01-03	2008-01-03	2008-01-03
DROP TABLE t1;
CREATE TABLE t1(c1 INT);
INSERT INTO t1 VALUES(1),(2),(3);
EXPLAIN (SELECT c1 FROM t1) UNION ALL (SELECT c1 FROM t1) LIMIT 2;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	PRIMARY	t1	NULL	ALL	NULL	NULL	NULL	NULL	3	100.00	Parallel scan (4 workers)
2	UNION	t1	NULL	ALL	NULL	NULL	NULL	NULL	3	100.00	Parallel scan (4 workers)
Warnings:
Note	1003	/* select#1 */ select `test`.`t1`.`c1` AS `c1` from `test`.`t1` union all /* select#2 */ select `test`.`t1`.`c1` AS `c1` from `test`.`t1` limit 2
Note	1003	Query is executed in a parallel plan;  explain with tree format to see the plan details.
(SELECT cN FROM tN) UNION ALL (SELECT cN FROM tN) LIMIT N;
cN
N
N
DROP TABLE t1;
