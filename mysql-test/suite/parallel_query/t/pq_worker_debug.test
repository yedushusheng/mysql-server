--source include/have_debug.inc
--source suite/parallel_query/include/pq_default.inc

CREATE TABLE t1(a INT);
INSERT INTO t1 VALUES(1), (2);

--echo ### worker initialization failure tests ###
SELECT * FROM t1;
SET debug = 'd,pq_simulate_worker_prepare_query_plan_error_1';
--error ER_DA_UNKNOWN_ERROR_NUMBER
SELECT * FROM t1;
SET debug = '-d,pq_simulate_worker_prepare_query_plan_error_1';

SET debug = 'd,pq_simulate_worker_prepare_query_plan_error_2';
--error ER_DA_UNKNOWN_ERROR_NUMBER
SELECT * FROM t1;
SET debug = '-d,pq_simulate_worker_prepare_query_plan_error_2';

INSERT INTO t1 WITH RECURSIVE gen(a) AS (SELECT 1 UNION ALL SELECT a + 1 FROM gen WHERE a < 20) SELECT * FROM gen;
--echo ### one worker send partial result to leader ###
SET debug = 'd,pq_simulate_one_worker_part_result_error';
--error ER_DA_UNKNOWN_ERROR_NUMBER
SELECT * FROM t1 ORDER BY a LIMIT 2 OFFSET 20;
SET debug = '-d,pq_simulate_one_worker_part_result_error';

DROP TABLE t1;
