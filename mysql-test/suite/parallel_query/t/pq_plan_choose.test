--source suite/parallel_query/include/pq_default.inc

# We don't support IN sub query because we don't support clone of its refs in
# items yet.
CREATE TABLE t1 (f1 INT, f2 INT);
INSERT INTO t1 VALUES (1, 0), (2, 1), (3, 2);
CREATE TABLE t2 (f1 INT, f2 INT);

EXPLAIN FORMAT=tree SELECT t1.f1
FROM t1
HAVING (3, 2) IN (SELECT f1, f2 FROM t2) AND t1.f1  >= 0
ORDER BY t1.f1;
DROP TABLE t1, t2;

# Don't support Item_func_not_all() with subquery
CREATE TABLE t1(a int);
SELECT 1 FROM t1 WHERE 1 > ALL(SELECT 1 FROM t1 WHERE a);
DROP TABLE t1;

# Don't choose parallel plan if table ref items is not parallel safe
CREATE TABLE t1(a INT, b INT, INDEX(b));
insert into t1 values (1, 1),(2, 2);
CREATE FUNCTION f1() RETURNS INT DETERMINISTIC RETURN 1;
EXPLAIN FORMAT=tree SELECT * FROM t1 WHERE b = f1();
DROP TABLE t1;
DROP FUNCTION f1;