SET max_parallel_degree = 1;

CREATE TABLE t1(a int primary key, b int, c text, index(b));
INSERT INTO t1 VALUES(1, 1, '1'),(2, 2, '2');

EXPLAIN FORMAT=tree SELECT * FROM t1;

# parallel plan should be choosed because there is no blob in collector table.
EXPLAIN FORMAT=tree SELECT b FROM t1 where c = 1;
EXPLAIN FORMAT=tree SELECT a, b FROM t1 WHERE a = 1;
EXPLAIN FORMAT=tree SELECT a, b FROM t1 WHERE b = 1;
EXPLAIN FORMAT=tree SELECT b FROM t1 WHERE b between 1 and 2;

DROP TABLE t1;

# We don't support IN sub query because we don't support clone of its refs in
# items yet.
CREATE TABLE t1 (f1 INT, f2 INT);
INSERT INTO t1 VALUES (1, 0), (2, 1), (3, 2);
CREATE TABLE t2 (f1 INT, f2 INT);

SET optimizer_trace = 'enabled=on';
EXPLAIN FORMAT=tree SELECT t1.f1
FROM t1
HAVING (3, 2) IN (SELECT f1, f2 FROM t2) AND t1.f1  >= 0
ORDER BY t1.f1;
SELECT JSON_SEARCH(trace, 'all', 'IN_subquery_strategy_is_SUBQ_EXISTS') is not null has_refuse_reason from information_schema.optimizer_trace;

DROP TABLE t1, t2;
